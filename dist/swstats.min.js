/*! swstats 2017-06-08 */

"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,s){for(var n=0;n<s.length;n++){var r=s[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(s,n,r){return n&&t(s.prototype,n),r&&t(s,r),s}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function t(s,n,r){function e(o,a){if(!n[o]){if(!s[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(i)return i(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var f=n[o]={exports:{}};s[o][0].call(f.exports,function(t){var n=s[o][1][t];return e(n||t)},f,f.exports,t,s,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)e(r[o]);return e}({1:[function(t,s,n){!function(s){var n=t("./main.js");s.SWindow=n}(window)},{"./main.js":3}],2:[function(t,s,n){s.exports={sum:function(t,s,n,r,e,i){t=void 0===t?{}:t;for(var o=s.length,a=n.length,u=0;u<o;u++)for(var h in s[u].v)t[h]=t[h]||0,t[h]+=s[u].v[h];for(var f=0;f<a;f++)for(var c in n[f].v)t[c]=t[c]||0,t[c]-=n[f].v[c];return t},freq:function(t,s,n,r,e,i){var o=e.sum,a=0,u={};for(var h in o)a+=o[h];for(var f in o)u[f]=o[f]/a;return u},mode:function(t,s,n,r,e,i){var o=e.sum,a=[];for(var u in o)a.push({k:u,t:o[u]});return a.sort(function(t,s){return t.t-s.t}),(a.pop()||{}).k}}},{}],3:[function(t,s,n){function r(t){if("object"!=(void 0===t?"undefined":_typeof(t)))return t;var s={};for(var n in t)s[n]=r(t[n]);return s}function e(t,s,n,r,e){p[t][s]={fn:r,deps:n},e&&c[t].push(s)}function i(t,s,n){var r=p[n][t].deps;return!!r.length&&(r.indexOf(s)>=0||r.reduce(function(t,r){return t||i(r,s,n)},!1))}function o(t,s){var n={},r=!1;t.forEach(function(t){return n[t]=!0});do{r=!1,t.forEach(function(e){p[s][e].deps.forEach(function(s){n[s]||(n[s]=!0,t.push(s),r=!0)})})}while(r);if(t.length>1){var e=null,o=!1;do{o=!1;for(var a=0;a<t.length;a++)for(var u=a;u<t.length;u++)i(t[a],t[u],s)&&(e=t[a],t[a]=t[u],t[u]=e,o=!0)}while(o)}}var a=t("./nops.js"),u=t("./cops.js"),h=[],f={numeric:"numeric",category:"category"},c={numeric:["count","sum","avg","stdev"],category:["sum","freq","mode"]},v={type:f.numeric,ops:c.numeric,step:1e3},p={numeric:{count:{fn:a.count,deps:[]},sum:{fn:a.sum,deps:[]},avg:{fn:a.avg,deps:[]},stdev:{fn:a.stdev,deps:["avg"]}},category:{sum:{fn:u.sum,deps:[]},freq:{fn:u.freq,deps:["sum"]},mode:{fn:u.mode,deps:["sum"]}}};setInterval(function(){var t=Date.now();h.filter(function(t){return!t._pause}).forEach(function(s){for(var n=s._arr,e=s._time,i=s._type,o=[],a=r(s.stats);n.length&&t-n[0].t>e;)o.push(n.shift());s._ops.forEach(function(t){s.stats[t]=p[i][t].fn(s.stats[t],[],o,s._arr,s.stats,a)})})},1e3);var l=function(){function t(s,n){_classCallCheck(this,t),n=n||v,this._options=n,this._arr=[],this._time=s||1e4,this._type=n.type||v.type,this._ops=n.ops||c[this._type],this._step=n.step||v.step,this._pause=!1,this._active=!0,this._oldstats={},this.stats=r(n.stats||{}),o(this._ops,this._type),h.push(this)}return _createClass(t,[{key:"clean",value:function(){this._arr=[],this._oldstats={},this.stats=r(this._options.stats||{})}},{key:"push",value:function(t){if(this._active&&!this._pause)return t=t instanceof Array?t:[t],this._type==f.numeric?this._pushNum(t):this._pushCat(t)}},{key:"pause",value:function(){this._pause=!0}},{key:"resume",value:function(t){var s=this._arr;if(t&&s.length){var n=Date.now()-s[s.length].t;s.length.forEach(function(t){return t.t+=n})}this._pause=!1}},{key:"destroy",value:function(){var t=h.indexOf(this);h.splice(t,1),this._active=!1}},{key:"_pushNum",value:function(t){var s=this,n=Date.now(),e=this._arr,i=this._type,o=r(this.stats);t=t.map(function(t){return{t:n,v:t,l:1}}),e.length||e.push({t:n,v:0,l:0});var a=r(e[e.length-1]);if(n-a.t<this._step){t.forEach(function(t){a.v+=t.v,a.l+=1});var u=[e.pop()],h=[a];e.push(a),this._ops.forEach(function(t){s.stats[t]=p[i][t].fn(s.stats[t],h,u,e,s.stats,o)})}else t.forEach(function(t){e.push(t)}),this._ops.forEach(function(n){s.stats[n]=p[i][n].fn(s.stats[n],t,[],e,s.stats,o)});return this}},{key:"_pushCat",value:function(t){var s=this,n=Date.now(),e=this._arr,i=this._type,o=r(this.stats),a={};t.forEach(function(t){a[t]=a[t]||0,a[t]++}),e.length||e.push({t:n,v:{}});var u=r(e[e.length-1]);if(n-u.t<this._step){for(var h in a)u.v[h]=u.v[h]||0,u.v[h]+=a[h];var f=[e.pop()],c=[u];e.push(u),this._ops.forEach(function(t){s.stats[t]=p[i][t].fn(s.stats[t],c,f,e,s.stats,o)})}else{var v={t:n,v:a};e.push(v),this._ops.forEach(function(t){s.stats[t]=p[i][t].fn(s.stats[t],[v],[],e,s.stats,o)})}return this}},{key:"length",get:function(){return this._arr.length}}]),t}(),_=function(){function t(s,n){_classCallCheck(this,t),n=n||v,this._options=n,this._arr=[],this._size=s||1e3,this._type=n.type||v.type,this._ops=n.ops||c[this._type],this.stats=r(n.stats||{}),o(this._ops,this._type)}return _createClass(t,[{key:"clean",value:function(){this._arr=[],this._oldstats={},this.stats=r(this._options.stats||{})}},{key:"push",value:function(t){return t=t instanceof Array?t:[t],this._type==f.numeric?this._pushNum(t):this._pushCat(t)}},{key:"_pushNum",value:function(t){var s=this,n=this._arr,e=[],i=this._type,o=r(this.stats);for((t=t.map(function(t){return{v:t,l:1}})).forEach(function(t){return s._arr.push(t)});this._arr.length>this._size;)e.push(this._arr.shift());return this._ops.forEach(function(r){s.stats[r]=p[i][r].fn(s.stats[r],t,e,n,s.stats,o)}),this}},{key:"_pushCat",value:function(t){var s=this,n=this._arr,e=[],i=this._type,o=r(this.stats),a={v:{}};for(t.forEach(function(t){a.v[t]=a.v[t]||0,a.v[t]++}),this._arr.push(a);this._arr.length>this._size;)e.push(this._arr.shift());return this._ops.forEach(function(t){s.stats[t]=p[i][t].fn(s.stats[t],[a],e,n,s.stats,o)}),this}},{key:"length",get:function(){return this._arr.length}}]),t}();s.exports={TimeStats:l,SizeStats:_,register:e}},{"./cops.js":2,"./nops.js":4}],4:[function(t,s,n){var r={count:function(t,s,n,r,e,i){for(var o=0,a=r.length,u=0;u<a;u++)o+=r[u].l||1;return o},sum:function(t,s,n,r,e,i){t=void 0===t?0:t;for(var o=s.length,a=n.length,u=0;u<o;u++)t+=s[u].v;for(var h=0;h<a;h++)t-=n[h].v;return t},avg:function(t,s,n,e,i,o){var a=r.count(0,0,0,s),u=r.count(0,0,0,n),h=r.count(0,0,0,e),f=h-a+u;t=void 0===t?0:t,t*=f;for(var c=0;c<s.length;c++)t+=s[c].v;for(var v=0;v<n.length;v++)t-=n[v].v;return t/=h,isNaN(t)?0:t},stdev:function(t,s,n,e,i,o){o.stdev=o.stdev||{avg:1,sqsum:0,sum:0,stdev:0};for(var a=r.count(0,0,0,s),u=r.count(0,0,0,n),h=(r.count(0,0,0,e),e.length),f=(o.avg,o.stdev.avg,o.stdev.sqsum),c=o.stdev.sum,v=i.avg||0,p=f,l=c,_=0;_<n.length;_++){var y=n[_].v/(n[_].l||1);p-=y*y,l-=y}for(var m=0;m<s.length;m++){var g=s[m].v/(s[m].l||1);p+=g*g,l+=g}var d=Math.sqrt((p-2*v*l+h*v*v)/h);return{avg:v,sqsum:p,sum:l,stdev:d}}};s.exports=r},{}]},{},[1]);