{"version":3,"sources":["swstats.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","$","SWindow","window","sum","currval","newitems","olditems","allitems","newstats","oldstats","undefined","ln","lo","j","v","freq","sums","total","res","mode","map","push","k","sort","b","pop","NOps","COps","IVAL","LIST","TYPES","numeric","category","DEF_OPS","DEF_OPTIONS","type","ops","step","OPS","fn","count","deps","max","min","avg","stdev","clone","obj","register","name","def","depends","indexOf","reduce","curr","val","sortOps","forEach","op","dep","tmp","it","setInterval","now","Date","filter","sws","_pause","arr","_arr","time","_time","_type","old","stats","shift","_ops","TimeStats","options","_options","_step","_active","_oldstats","vals","Array","_pushNum","_pushCat","last","diff","idx","splice","Infinity","Math","oa","na","item","win","slot","SizeStats","size","_size","len","nvl","ovl","isNaN","sqsum","oavg","oldavg","oldsqsum","oldsum","newavg","newsqsum","newsum","sqrt"],"mappings":"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","file":"swstats.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\r\n\r\n(function($) {\r\n\tvar SWindow = require(\"./main.js\");\r\n\t$.SWindow = SWindow;\r\n})(window);\r\n\n},{\"./main.js\":3}],2:[function(require,module,exports){\nmodule.exports = {\r\n\tsum(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tcurrval = currval===undefined? {} : currval;\r\n\t\tvar ln = newitems.length, lo = olditems.length;\r\n\t\tfor(let i=0;i<ln;i++) {\r\n\t\t\tfor(let j in newitems[i].v) {\r\n\t\t\t\tcurrval[j] = currval[j] || 0;\r\n\t\t\t\tcurrval[j] += newitems[i].v[j];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(let i=0;i<lo;i++) {\r\n\t\t\tfor(let j in olditems[i].v) {\r\n\t\t\t\tcurrval[j] = currval[j] || 0;\r\n\t\t\t\tcurrval[j] -= olditems[i].v[j];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn currval;\r\n\t},\r\n\tfreq(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tvar sums = newstats.sum;\r\n\t\tvar total = 0, res = {};\r\n\t\tfor(let i in sums) total += sums[i];\r\n\t\tfor(let i in sums) res[i] = sums[i] / total;\r\n\t\treturn res;\r\n\t},\r\n\tmode(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tvar sums = newstats.sum;\r\n\t\tvar map = [];\r\n\t\tfor(let i in sums) map.push({k:i,t:sums[i]});\r\n\t\tmap.sort((a,b)=>a.t-b.t);\r\n\t\treturn (map.pop()||{}).k;\r\n\t}\r\n}\r\n\n},{}],3:[function(require,module,exports){\nconst NOps = require(\"./nops.js\");\r\nconst COps = require(\"./cops.js\");\r\n\r\nconst IVAL = 1000;\t// Slide window interval\r\nconst LIST = [];\t\t// Active window instances\r\n\r\n// Stats function type constants\r\nconst TYPES = {\r\n\tnumeric : \"numeric\",\r\n\tcategory : \"category\"\r\n};\r\n\r\n// Default operations\r\nconst DEF_OPS = {\r\n\tnumeric : [\"count\",\"sum\",\"max\",\"min\",\"avg\",\"stdev\"],\r\n\tcategory : [\"sum\",\"freq\",\"mode\"]\r\n};\r\n\r\n// Default options\r\nconst DEF_OPTIONS = {\r\n\ttype : TYPES.numeric,\r\n\tops : DEF_OPS.numeric,\r\n\tstep : 1000\r\n};\r\n\r\n// Registered operations\r\nconst OPS = {\r\n\tnumeric : {\r\n\t\t\"count\" : {fn:NOps.count,deps:[]},\r\n\t\t\"sum\" : {fn:NOps.sum,deps:[]},\r\n\t\t\"max\" : {fn:NOps.max,deps:[]},\r\n\t\t\"min\" : {fn:NOps.min,deps:[]},\r\n\t\t\"avg\" : {fn:NOps.avg,deps:[]},\r\n\t\t\"stdev\" : {fn:NOps.stdev,deps:[\"avg\"]},\r\n\t},\r\n\tcategory : {\r\n\t\t\"sum\" : {fn:COps.sum,deps:[]},\r\n\t\t\"freq\" : {fn:COps.freq,deps:[\"sum\"]},\r\n\t\t\"mode\" : {fn:COps.mode,deps:[\"sum\"]}\r\n\t}\r\n};\r\n\r\n/**\r\n * Simple object clone function\r\n */\r\nfunction clone(obj) {\r\n\tif(typeof(obj)!=\"object\") {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tvar o = {};\r\n\t\tfor(var i in obj) o[i] = clone(obj[i]);\r\n\t\treturn o;\r\n\t}\r\n}\r\n\r\n/**\r\n * Registers a new operation\r\n * @param type [TYPES.numeric / TYPES.category]\r\n * @param name The name of the stat function\r\n * @param deps Array of dependency names\r\n * @param fn Stats function to be called, in the form of\r\n * fn(currval,newitems,olditems,allitems,newstats,oldstats)\r\n * @param def Use by default.\r\n */\r\nfunction register(type,name,deps,fn,def) {\r\n\tOPS[type][name] = {fn:fn,deps:deps};\r\n\tif(def) DEF_OPS[type].push(name);\r\n}\r\n\r\nfunction depends(a,b,type) {\r\n\tvar deps = OPS[type][a].deps;\r\n\tif(!deps.length) return false;\r\n\telse if(deps.indexOf(b)>=0) return true;\r\n\telse {\r\n\t\treturn deps.reduce((curr,val)=>curr||depends(val,b,type),false);\r\n\t}\r\n}\r\n\r\n/**\r\n * Sorts category operations by its dependencies\r\n */\r\nfunction sortOps(ops,type) {\r\n\tvar map = {}, n = false;\r\n\r\n\tops.forEach(op=>map[op] = true);\r\n\tdo {\r\n\t\tn = false;\r\n\t\tops.forEach(op=>{\r\n\t\t\tOPS[type][op].deps.forEach(dep=>{\r\n\t\t\t\tif(!map[dep]) {\r\n\t\t\t\t\tmap[dep] = true;\r\n\t\t\t\t\tops.push(dep);\r\n\t\t\t\t\tn = true;\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t});\r\n\t}while(n);\r\n\r\n\t// Stupid sort because Array.sort will not work with dependency sorting\r\n\tif(ops.length>1) {\r\n\t\tlet tmp = null, it = false;\r\n\t\tdo {\r\n\t\t\tit = false;\r\n\t\t\tfor(let i=0;i<ops.length;i++) {\r\n\t\t\t\tfor(let j=i;j<ops.length;j++) {\r\n\t\t\t\t\tif(depends(ops[i],ops[j],type)) {\r\n\t\t\t\t\t\ttmp = ops[i];\r\n\t\t\t\t\t\tops[i] = ops[j];\r\n\t\t\t\t\t\tops[j] = tmp;\r\n\t\t\t\t\t\tit = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}while(it);\r\n\t}\r\n}\r\n\r\n/**\r\n * Slide time window interval\r\n */\r\nsetInterval(()=>{\r\n\tvar now = Date.now();\r\n\r\n\t// For each stat created object\r\n\tLIST.filter(sws=>!sws._pause).forEach(sws=>{\r\n\t\tvar arr = sws._arr, time = sws._time;\r\n\t\tvar type = sws._type;\r\n\t\tvar old = [];\r\n\t\tvar oldstats = clone(sws.stats);\r\n\r\n\t\t// Remove slots whose date has expired\r\n\t\twhile(arr.length && now-arr[0].t>time)\r\n\t\t\told.push(arr.shift());\r\n\r\n\t\t// Execute each stat operation over the remaining slots\r\n\t\tsws._ops.forEach(op=>{\r\n\t\t\tsws.stats[op] = OPS[type][op].fn(sws.stats[op],[],old,sws._arr,sws.stats,oldstats);\r\n\t\t});\r\n\t});\r\n},IVAL);\r\n\r\n/**\r\n * TimeStats Slide Window\r\n * @param time Time (ms) of the duration of the window, before slide\r\n * @param options Object\r\n */\r\nclass TimeStats {\r\n\tconstructor(time,options) {\r\n\t\toptions = options || DEF_OPTIONS;\r\n\t\tthis._options = options;\r\n\t\tthis._arr = [];\r\n\t\tthis._time = time || 10000;\r\n\t\tthis._type = options.type || DEF_OPTIONS.type;\r\n\t\tthis._ops = options.ops || DEF_OPS[this._type];\r\n\t\tthis._step = options.step || DEF_OPTIONS.step;\r\n\t\tthis._pause = false;\r\n\t\tthis._active = true;\r\n\t\tthis._oldstats = {};\r\n\t\tthis.stats = clone(options.stats||{});\r\n\r\n\t\tsortOps(this._ops,this._type);\r\n\t\tLIST.push(this);\r\n\t}\r\n\r\n\tget length() {\r\n\t\treturn this._arr.length;\r\n\t}\r\n\r\n\tclean() {\r\n\t\tthis._arr = [];\r\n\t\tthis._oldstats = {};\r\n\t\tthis.stats = clone(this._options.stats||{});\r\n\t}\r\n\r\n\tpush(vals) {\r\n\t\tif(!this._active || this._pause) return;\r\n\r\n\t\tvals = vals instanceof Array? vals : [vals];\r\n\r\n\t\treturn this._type==TYPES.numeric?\r\n\t\t\tthis._pushNum(vals) :\r\n\t\t\tthis._pushCat(vals);\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis._pause = true;\r\n\t}\r\n\r\n\tresume(shift) {\r\n\t\tvar arr = this._arr;\r\n\t\tif(shift && arr.length) {\r\n\t\t\tvar now = Date.now();\r\n\t\t\tvar last = arr[arr.length].t;\r\n\t\t\tvar diff = now - last;\r\n\t\t\tarr.length.forEach(v=>v.t+=diff);\r\n\t\t}\r\n\t\tthis._pause = false;\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tvar idx = LIST.indexOf(this);\r\n\t\tLIST.splice(idx,1);\r\n\t\tthis._active = false;\r\n\t}\r\n\r\n\t_pushNum(vals) {\r\n\t\tvar now = Date.now();\r\n\t\tvar arr = this._arr;\r\n\t\tvar type = this._type;\r\n\t\tvar oldstats = clone(this.stats);\r\n\r\n\t\tvals = vals.map(v=>{return {t:now,v:v,l:1,max:v,min:v};});\r\n\r\n\t\tif(!arr.length) arr.push({t:now,v:0,l:0,max:-Infinity,min:Infinity});\r\n\t\tvar last = clone(arr[arr.length-1]);\r\n\r\n\t\tif(now-last.t < this._step) {\r\n\t\t\tvals.forEach(v=>{\r\n\t\t\t\tlast.v+=v.v; last.l+=1;\r\n\t\t\t\tlast.max = Math.max(last.max,v.v),\r\n\t\t\t\tlast.min = Math.min(last.min,v.v)\r\n\t\t\t});\r\n\t\t\tvar oa = [arr.pop()], na = [last];\r\n\t\t\tarr.push(last);\r\n\t\t\tthis._ops.forEach(op=>{\r\n\t\t\t\tthis.stats[op] = OPS[type][op].fn(this.stats[op],na,oa,arr,this.stats,oldstats);\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvals.forEach(v=>{arr.push(v)});\r\n\t\t\tthis._ops.forEach(op=>{\r\n\t\t\t\tthis.stats[op] = OPS[type][op].fn(this.stats[op],vals,[],arr,this.stats,oldstats);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t_pushCat(vals) {\r\n\t\tvar now = Date.now();\r\n\t\tvar arr = this._arr;\r\n\t\tvar type = this._type;\r\n\t\tvar oldstats = clone(this.stats);\r\n\t\tvar map = {}\r\n\r\n\t\tvals.forEach(v=>{\r\n\t\t\tmap[v] = map[v] || 0;\r\n\t\t\tmap[v]++;\r\n\t\t});\r\n\r\n\t\tif(!arr.length) arr.push({t:now,v:{}});\r\n\t\tvar last = clone(arr[arr.length-1]);\r\n\r\n\t\tif(now-last.t < this._step) {\r\n\t\t\tfor(let i in map) {\r\n\t\t\t\tlast.v[i] = last.v[i] || 0;\r\n\t\t\t\tlast.v[i] += map[i];\r\n\t\t\t}\r\n\t\t\tvar oa = [arr.pop()], na = [last];\r\n\t\t\tarr.push(last);\r\n\t\t\tthis._ops.forEach(op=>{\r\n\t\t\t\tthis.stats[op] = OPS[type][op].fn(this.stats[op],na,oa,arr,this.stats,oldstats);\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar item = {t:now,v:map};\r\n\t\t\tarr.push(item);\r\n\t\t\tthis._ops.forEach(op=>{\r\n\t\t\t\tthis.stats[op] = OPS[type][op].fn(this.stats[op],[item],[],arr,this.stats,oldstats);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tget window() {\r\n\t\tlet type = this._type;\r\n\t\tlet win = this._arr.map(slot=>{\r\n\t\t\tlet ops = {};\r\n\t\t\tthis._ops.forEach(op=>{\r\n\t\t\t\tops[op] = OPS[type][op].fn(undefined,[slot],[],[slot],ops,{});\r\n\t\t\t});\r\n\t\t\treturn ops;\r\n\t\t});\r\n\t\treturn win;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn this.stats;\r\n\t}\r\n}\r\n\r\n/**\r\n * SizeStats Slide Window\r\n * @param size Number of maximum slots before slide\r\n * @param options Object\r\n */\r\nclass SizeStats {\r\n\tconstructor(size,options) {\r\n\t\toptions = options || DEF_OPTIONS;\r\n\r\n\t\tthis._options = options;\r\n\t\tthis._arr = [];\r\n\t\tthis._size = size || 1000;\r\n\t\tthis._type = options.type || DEF_OPTIONS.type;\r\n\t\tthis._ops = options.ops || DEF_OPS[this._type];\r\n\t\tthis.stats = clone(options.stats||{});\r\n\r\n\t\tsortOps(this._ops,this._type);\r\n\t}\r\n\r\n\tclean() {\r\n\t\tthis._arr = [];\r\n\t\tthis._oldstats = {};\r\n\t\tthis.stats = clone(this._options.stats||{});\r\n\t}\r\n\r\n\tget length() {\r\n\t\treturn this._arr.length;\r\n\t}\r\n\r\n\tpush(vals) {\r\n\t\tvals = vals instanceof Array? vals : [vals];\r\n\r\n\t\treturn this._type==TYPES.numeric?\r\n\t\t\tthis._pushNum(vals) :\r\n\t\t\tthis._pushCat(vals);\r\n\t}\r\n\r\n\t_pushNum(vals) {\r\n\t\tvar arr = this._arr, old = [];\r\n\t\tvar type = this._type;\r\n\t\tvar oldstats = clone(this.stats);\r\n\r\n\t\tvals = vals.map(v=>{return {v:v,l:1,max:v,min:v};});\r\n\t\tvals.forEach(v=>this._arr.push(v));\r\n\r\n\t\twhile(this._arr.length>this._size) {\r\n\t\t\told.push(this._arr.shift());\r\n\t\t}\r\n\r\n\t\tthis._ops.forEach(op=>{\r\n\t\t\tthis.stats[op] = OPS[type][op].fn(this.stats[op],vals,old,arr,this.stats,oldstats);\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t_pushCat(vals) {\r\n\t\tvar arr = this._arr, old = [];\r\n\t\tvar type = this._type;\r\n\t\tvar oldstats = clone(this.stats);\r\n\t\tvar map = {v:{}};\r\n\r\n\t\tvals.forEach(v=>{\r\n\t\t\tmap.v[v] = map.v[v] || 0;\r\n\t\t\tmap.v[v]++;\r\n\t\t});\r\n\t\tthis._arr.push(map);\r\n\r\n\t\twhile(this._arr.length>this._size) {\r\n\t\t\told.push(this._arr.shift());\r\n\t\t}\r\n\r\n\t\tthis._ops.forEach(op=>{\r\n\t\t\tthis.stats[op] = OPS[type][op].fn(this.stats[op],[map],old,arr,this.stats,oldstats);\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tget window() {\r\n\t\tlet type = this._type;\r\n\t\tlet win = this._arr.map(slot=>{\r\n\t\t\tlet ops = {};\r\n\t\t\tthis._ops.forEach(op=>{\r\n\t\t\t\tops[op] = OPS[type][op].fn(undefined,[slot],[],[slot],ops,{});\r\n\t\t\t});\r\n\t\t\treturn ops;\r\n\t\t});\r\n\t\treturn win;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn this.stats;\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tTimeStats : TimeStats,\r\n\tSizeStats : SizeStats,\r\n\tregister : register\r\n};\r\n\n},{\"./cops.js\":2,\"./nops.js\":4}],4:[function(require,module,exports){\nconst OPS = {\r\n\tcount(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tvar t = 0, len = allitems.length;\r\n\t\tfor(var i=0;i<len;i++) t += (allitems[i].l||1);\r\n\t\treturn t;\r\n\t},\r\n\tsum(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tcurrval = currval===undefined? 0 : currval;\r\n\t\tvar ln = newitems.length, lo = olditems.length;\r\n\t\tfor(let i=0;i<ln;i++) currval += newitems[i].v;\r\n\t\tfor(let i=0;i<lo;i++) currval -= olditems[i].v;\r\n\r\n\t\treturn currval;\r\n\t},\r\n\tmax(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tvar max = -Infinity, len = allitems.length;\r\n\t\tfor(let i=0;i<len;i++)\r\n\t\t\tmax = Math.max(max,allitems[i].max);\r\n\t\treturn max;\r\n\t},\r\n\tmin(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tvar min = Infinity, len = allitems.length;\r\n\t\tfor(let i=0;i<len;i++)\r\n\t\t\tmin = Math.min(min,allitems[i].min);\r\n\t\treturn min;\r\n\t},\r\n\tavg(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\tvar\r\n\t\t\tln = OPS.count(0,0,0,newitems), lo = OPS.count(0,0,0,olditems),\r\n\t\t\tnvl = OPS.count(0,0,0,allitems), ovl = nvl-ln+lo;\r\n\r\n\t\tcurrval = currval===undefined? 0 : currval;\r\n\t\tcurrval = currval * ovl;\r\n\r\n\t\tfor(let i=0;i<newitems.length;i++) currval += newitems[i].v;\r\n\t\tfor(let i=0;i<olditems.length;i++) currval -= olditems[i].v;\r\n\t\tcurrval = currval / nvl;\r\n\t\treturn isNaN(currval)? 0 : currval;\r\n\t},\r\n\tstdev(currval,newitems,olditems,allitems,newstats,oldstats) {\r\n\t\toldstats.stdev = oldstats.stdev || {avg:1,sqsum:0,sum:0,stdev:0};\r\n\r\n\t\tvar\r\n\t\t\tln = OPS.count(0,0,0,newitems), lo = OPS.count(0,0,0,olditems),\r\n\t\t\tnvl = OPS.count(0,0,0,allitems), ovl = nvl-ln+lo,\r\n\t\t\tlen = allitems.length,\r\n\t\t\toavg = oldstats.avg || 0;\r\n\r\n\t\tvar oldavg = oldstats.stdev.avg;\r\n\t\tvar oldsqsum = oldstats.stdev.sqsum;\r\n\t\tvar oldsum = oldstats.stdev.sum;\r\n\t\tvar newavg = newstats.avg || 0;\r\n\t\tvar newsqsum = oldsqsum;\r\n\t\tvar newsum = oldsum;\r\n\r\n\t\tfor(let i=0;i<olditems.length;i++) {\r\n\t\t\tlet it = olditems[i].v / (olditems[i].l||1);\r\n\t\t\tnewsqsum -= it*it;\r\n\t\t\tnewsum -= it;\r\n\t\t}\r\n\r\n\t\tfor(let i=0;i<newitems.length;i++) {\r\n\t\t\tlet it = newitems[i].v / (newitems[i].l||1);\r\n\t\t\tnewsqsum += it*it;\r\n\t\t\tnewsum += it;\r\n\t\t}\r\n\r\n\t\tvar stdev = Math.sqrt((newsqsum - 2*newavg*newsum + len*newavg*newavg) / len);\r\n\t\treturn {\r\n\t\t\tavg : newavg,\r\n\t\t\tsqsum : newsqsum,\r\n\t\t\tsum : newsum,\r\n\t\t\tstdev : stdev\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = OPS;\r\n\n},{}]},{},[1]);\n"]}